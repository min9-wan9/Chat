<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Chat Room</title>
    <style>
        body {
            font-family: Arial;
            max-width: 700px;
            margin: 30px auto;
        }
        input, button {
            padding: 8px;
            margin: 4px 0;
            width: 100%;
        }
        #chat {
            border: 1px solid #ccc;
            height: 300px;
            overflow-y: auto;
            padding: 10px;
            margin: 10px 0;
        }
    </style>
</head>
<body>

<h2>Chat Room</h2>

<input id="username" placeholder="Tên của bạn">
<input id="room" placeholder="Tên phòng (vd: Java)">
<button onclick="join()">Vào phòng</button>

<div id="chat"></div>

<input id="message" placeholder="Nhập tin nhắn">
<button onclick="send()">Gửi</button>

<script>
    const ws = new WebSocket("ws://localhost:8080/chat");
    const chatDiv = document.getElementById("chat");

    ws.onopen = () => log("✅ Kết nối server");
    ws.onmessage = (e) => log(e.data);
    ws.onclose = () => log("❌ Mất kết nối");

    function log(text) {
        chatDiv.innerHTML += `<div>${text}</div>`;
        chatDiv.scrollTop = chatDiv.scrollHeight;
    }

    function join() {
        const user = username.value;
        const roomName = room.value;
        ws.send(`JOIN|${roomName}|${user}`);
    }

    function send() {
        ws.send(`MSG|${message.value}`);
        message.value = "";
    }
</script>

</body>
</html>
